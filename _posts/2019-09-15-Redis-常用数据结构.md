---
layout: post
title:  "Redis-常用数据结构"
date:   2019-09-15 18:00:00 +0800
categories: 博客
tags: NOSQL
excerpt: "Redis的五种常见的数据结构介绍～"
---

## 1、五种数据结构
+ string
+ list
+ hash
+ set
+ zset

## 2、string
+ Redis最简单的数据结构
+ string底层时一个字符数组，包含三部分：每个字符、字符串长度、剩余可用长度
+ String类型是二进制安全的，意思是 redis 的 string 可以包含任何数据。如数字，字符串，jpg图片或者序列化的对象
+ 通过get/set/进行查询和设置参数，set时，吐过key之前已存在，则默认会替换
+ value最大值不能超过512M，
+ 可以通过nx来设置不覆盖之前已存在的value，set key value nx，如果key已存在，返回空，value还是修改之前的值
+ 如果value是整数，则可通过incr等命令进行自增
+ 可通过mset，mget命令添加或查询多组命令
+ 数据结构
![]({{site.url}}/assets/20190915_03/0.png){:width="100%"}
+ 适用场景
	+ 缓存：经典使用场景，把常用信息，字符串，图片或者视频等信息放到redis中，redis作为缓存层，mysql做持久化层，降低mysql的读写压力
	+ 计数器：redis是单线程模型，一个命令执行完才会执行下一个，同时数据可以一步落地到其他的数据源
	+ session：常见方案spring session + redis实现session共享
	+ 分布式锁

## 3、list
+ Redis列表是通过双向链表（linked list）来实现的
+ list是有序的，value可以重复，可以通过下标取出对应的value值，左右两边都能进行插入和删除数据
+ 插入速度非常快，使用lpush向一个只有10个元素的列表插入元素与向一个有一千万个元素的列表插入元素的速度是相同的
+ 查询速度比较慢，这和java中链表的特点一致（插入删除快，查找修改慢）
+ redis以链表实现列表list的一个原因为在数据库中向一个非常长的量表中快速插入数据是非常重要的
+ 可以在恒定时间内或者指定范围内的数据
+ 当需要快速访问一个非常大的集合中的元素时，可以通过使用另外一种数据结构，sorted set
+ 数据结构
![]({{site.url}}/assets/20190915_03/1.png){:width="100%"}
+ 使用技巧
	+ lpush+lpop=Stack(栈)
	+ lpush+rpop=Queue（队列）
	+ lpush+ltrim=Capped Collection（有限集合）
	+ lpush+brpop=Message Queue（消息队列）
+ 适用场景
	+ timeline：例如微博的时间轴，有人发布微博，用lpush加入时间轴，展示新的列表信息

## 4、hash
+ 是一个Mapmap，指值本身又是一种键值对结构
+ 数据结构
![]({{site.url}}/assets/20190915_03/2.png){:width="100%"}
+ 适用场景
	+ 缓存：能直观，相比string更节省空间，的维护缓存信息，如用户信息，视频信息等

## 5、set
+ 集合类型也是用来保存多个字符串的元素，但和列表不同的是集合中  
+ 不允许有重复的元素
+ 集合中的元素是无序的，不能通过索引下标获取元素 
+ 支持集合间的操作，可以取多个集合取交集、并集、差集
+ 数据结构
![]({{site.url}}/assets/20190915_03/3.png){:width="100%"}
+ 适用场景
	+ 标签（tag）,给用户添加标签，或者用户给消息添加标签，这样有同一标签或者类似标签的可以给推荐关注的事或者关注的人。
	+ 点赞，或点踩，收藏等，可以放到set中实现

## 6、zset
+ 有序集合和集合有着必然的联系，保留了集合不能有重复成员的特性，区别是，有序集合中的元素是可以排序的，它给每个元素设置一个分数，作为排序的依据
+ 有序集合中的元素不可以重复，但是score 分数 可以重复
+ 数据结构
![]({{site.url}}/assets/20190915_03/4.png){:width="100%"}
+ 适用场景
	+ 排行榜：有序集合经典使用场景。例如小说视频等网站需要对用户上传的小说视频做排行榜，榜单可以按照用户关注数，更新时间，字数等打分，做排行

## 7、Redis API
+ [http://redisdoc.com](http://redisdoc.com){:target="_blank"}
